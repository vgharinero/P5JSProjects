let map = [
    [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0],
]

let path = []

function setup()
{

    createCanvas(map[0].length * 40, map.length * 40)

    let aStar = new AStar({X: 1, Y: 0}, {X: 8, Y: 15}, map)
    let lastNode = aStar.find()
    for(let node = lastNode; node != null; node = node.parent) {
        console.log(node)
        path.push(node)
    }
}   

function draw()
{
    map.forEach((row, i) => {
        row.forEach((pos, j) => {
            new Node(j * 40, i * 40, pos == 1, pos == 2, pos == 3).draw()
        })
    })    

    path.forEach(node => {
        new Node(node.X * 40, node.Y * 40, false, false, true).draw()
    })
}

function mouseClicked(event)
{
    let X = Math.floor((event.clientX - 520) / 40)
    let Y = Math.floor((event.clientY - 145) / 40)

    if (start && !startPlaced)
    {
        map[Y][X] = (map[Y][X]) ? 0 : 2
    }
    else if (target && !targetPlaced)
    {
        map[Y][X] = (map[Y][X]) ? 0 : 3
    }
    else
    {
        map[Y][X] = (map[Y][X]) ? 0 : 1
    }
}